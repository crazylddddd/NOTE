# 约束

- [约束](#约束)
  - [什么是约束](#什么是约束)
  - [约束的分类](#约束的分类)
    - [非空约束](#非空约束)
      - [非空约束的作用](#非空约束的作用)
      - [非空约束的关键字](#非空约束的关键字)
      - [非空约束的特点](#非空约束的特点)
      - [添加非空约束](#添加非空约束)
      - [删除非空约束](#删除非空约束)
    - [唯一性约束](#唯一性约束)
      - [唯一性约束的作用](#唯一性约束的作用)
      - [唯一性约束的关键字](#唯一性约束的关键字)
      - [唯一性约束的他特点](#唯一性约束的他特点)
      - [添加唯一约束](#添加唯一约束)
        - [复合唯一约束](#复合唯一约束)
      - [删除唯一约束](#删除唯一约束)
    - [primary key 约束](#primary-key-约束)
      - [主键约束的作用](#主键约束的作用)
      - [关键字](#关键字)
      - [主键约束的特点](#主键约束的特点)
      - [添加主键约束](#添加主键约束)

## 什么是约束

- 约束是表级的强制规定
- 可以在创建表时规定约束，或者通过创建表时通过ALTER TABLE语句规定约束

## 约束的分类

- 根据约束列的限制分为
  - **单列约束**：每个约束只约束一行
  - **多列约束**：每个约束可约束多行数据
- 根据约束的作用范围分为：
  - **列级约束**：只能作用在一个列上，跟在列的定义后面
  - **表级**约束：可以作用在多个列上，不与列一起，而是单独定义
- 根据约束起的作用
  - **NOT NULL** 非空约束，规定某个字段不能为空
  - **UNIQUE** 唯一约束，规定某个字段在整表中唯一
  - **PRIMARY KEY** 主键(非空且唯一)约束
  - **FOREIGN KEY** 外键约束
  - **DEFAULT** 默认值约束

- 查看表已有的约束

    ```sql
    # information_schema(系统库)
    #table_constraints(专门储存各个表的约束)
    SELECT * FROM information_schema
    WHERE table_name = 'tableName'
    ```

### 非空约束

#### 非空约束的作用

- 限定某个字段或列的值不允许为空

#### 非空约束的关键字

- **NOT NULL**

#### 非空约束的特点

- 默认所以的类型的值都可以是NULL，包括INT，FLOAT等数据类型
- 非空约束只能出现在表对象的列上，只能某个列单独限定非空，不能组合非空
- 一个表可以有多个列限定非空
- **空字符串**不等于NULL，**0**也不等于NULL

#### 添加非空约束

1. 建表时

   ```sql
   create table table_name(
    field_nmae field_type,
    field_nmae field_type NOT NULL,
    field_nmae field_type,
   )
   ```

2. 建表后

   ```sql
   alter table table_name field_name field_type not null;
   ```

#### 删除非空约束

```sql
alter table table_name modify field_name field_type null

alter table table_name modify field_name field_type
```

### 唯一性约束

#### 唯一性约束的作用

- 用来限制某个字段/某列的值不能重复

#### 唯一性约束的关键字

- **UNIQUE**

#### 唯一性约束的他特点

- 同一个表可以有多个唯一约束
- 唯一约束可以是某一个值的唯一，也可以是多个列组合的值的唯一
- 唯一约束允许列值为空
- 在创建唯一约束的时候，如果不给唯一约束命名，默认与列名相同
- MYSQL会在唯一约束的列上默认创建一个唯一索引

#### 添加唯一约束

1. 建表时：

    ```sql
    create table table_name(
        field_name field_type,
        field_name field_type unique,
        field_name field_type unique key,
        field_name field_type
    );

    create table table_name(
        field_name field_type,
        field_name field_type,
        field_name field_type,
        [constraint 约束名] unique key(字段名)
    )
    ```

2. 建表后

    ```sql
    alter table table_name add unique kye(field_list)

    alter table table_name modify field_name field_type unique
    ```

##### 复合唯一约束

```sql
create table table_name(
    field_name field_type,
    field_name field_type,
    field_name field_type,
    unique key(field_list)
    # 字段列表中写的是多个字段名，用逗号分隔，表示复合唯一，即多个字段的组合是唯一的
)
```

#### 删除唯一约束

- 添加上唯一性约束的列也会自动创建唯一索引
- 删除唯一约束只能通过删除唯一索引的方式删除。
- 删除时需要指定唯一索引名，唯一索引名就和唯一约束名一样
- 若干创建唯一约束时没有指定名称
  - 单列，就默认和列相同
  - 组合列，默认与排在第一个的列名相同
  - 也可以自定义唯一性约束名

```sql
# 查看有哪些约束
select *
from information_schema.table_constratints
where table_name = "tableName"

alter table user
drop index .....;
```

### primary key 约束

#### 主键约束的作用

- 用来唯一标识表中的一行记录

#### 关键字

- **primary key**

#### 主键约束的特点

- 主键约束相当于唯一约束+非空约束的组合，主键约束不允许重复，也不允许出现空值
- 一个表最多只能有一个主键约束
- 建立主键约束可以在如下级别上创建
  - 列级别
  - 表级别
- 主键约束对应着表中的一列或多列(复合主键)
- 如果是多列组合的复合主键约束，那么这些列都不允许为空值，并且组合的值不允许重复
- MYSQL的主键名总是PRIMARY
- 当创建主键约束时，系统默认会在所在的列或列组合上建立对应的主键索引。如果删除主键约束，主键约束对应的索引就自动删除了。
- 不要修改主键字段的值。因为主键是数据记录的唯一标识，如果修改了主键的值，就有可能会破坏数据的完整性

#### 添加主键约束

- 建表时指定主键约束

  ```sql
    create table 表名称( 
        字段名 数据类型 primary key, #列级模式 
        字段名 数据类型,
        字段名 数据类型 
    );
    create table 表名称( 
        字段名 数据类型, 
        字段名 数据类型, 
        字段名 数据类型, 
        [constraint 约束名] primary key(字段名) #表级模式 
    )；
    ```
